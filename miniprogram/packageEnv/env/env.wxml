<!--pages/position/position.wxml-->
<wxs src="../../utils/common.wxs" module="common" />
<view class="container">
  <view wx:if="{{ isLoading }}" class="loader">
    <t-loading theme="circular" size="40rpx" />
  </view>
  <view wx:elif="{{ loadingError }}" class="loader">
    <view>{{ loadingError }}</view>
  </view>
  <view wx:esle class="main">
    <date-picker title="环境" bindpick="bindCalendarPick" />
    <view class="realtime">
      <view class="prefix">温湿度指标</view>
      <view class="rate">
        <view class="value">{{aggData0.mean }}</view>
        <view class="unit"> </view>
      </view>
      <view class="date">{{ aggData0.overview }}</view>
    </view>
    <ec-canvas id="env-chart" canvas-id="env-chart" ec="{{ ec }}" class="chart"></ec-canvas>
    <view class="card">
      <view class="header">
        <t-icon prefix="mdi" name="chart-pie" size="64rpx" color="#68B3F6" />
        <view class="title">温湿度区间</view>
      </view>
      <view class="divider" />
      <view class="ratio">
        <view class="ratio-part" style="{{ 'background-color:#68B3F6;width:' + aggData1.ratio + '%;' }}"></view>
        <view class="ratio-part" style="{{ 'background-color:#b1d8fa;width:' + aggData2.ratio + '%;' }}"></view>
        <view class="ratio-part" style="{{ 'background-color:#e1effc;width:' + aggData3.ratio + '%;' }}"></view>
      </view>
      <view class="box">
        <view class="row">
          <view class="block">
            <duration value="{{ aggData1.sum }}" />
            <view class="secondary">
              <t-icon prefix="mdi" name="square" size="20rpx" color="#68B3F6" />
              <view class="secondary-text" style="margin-left:10rpx;">较冷</view>
            </view>
          </view>
          <view class="block">
            <duration value="{{ aggData2.sum }}" />
            <view class="secondary">
              <t-icon prefix="mdi" name="square" size="20rpx" color="#b1d8fa" />
              <view class="secondary-text" style="margin-left:10rpx;">适中</view>
            </view>
          </view>
        </view>
        <view class="row">
          <view class="block">
            <duration value="{{ aggData3.sum }}" />
            <view class="secondary">
              <t-icon prefix="mdi" name="square" size="20rpx" color="#e1effc" />
              <view class="secondary-text" style="margin-left:10rpx;">较热</view>
            </view>
          </view>
        </view>
      </view>
    </view>
    <view class="card">
      <view class="header" bindtap="bindRealtimeTap">
        <t-icon prefix="mdi" name="chart-line" size="64rpx" color="#68B3F6" />
        <view class="title">实时环境</view>
      </view>
    </view>
  </view>
</view>
